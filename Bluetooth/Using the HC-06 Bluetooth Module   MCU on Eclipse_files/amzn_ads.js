function amzn_ads(e){"use strict";try{amznads.updateAds(e)}catch(t){try{console.log("amzn_ads: "+t)}catch(a){}}}function aax_write(e,t){e.write(t);e.close()}function aax_render_ad(e){if(e.passback){aax_write(document,e.html);return}var t=e.slotSize;if(!t){aax_write(document,e.html);return}var a=t.indexOf("x");var n=t.substring(0,a);var r=t.substring(a+1);var i="amznad"+Math.round(Math.random()*1e6);aax_write(document,'<iframe id="'+i+'" width="'+n+'" height="'+r+'" src="javascript:\'\'" scrolling="no" frameborder="0" marginwidth="0" marginheight="0" bgcolor="#FFFFFF" topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0"></iframe>');var o;try{o=document.getElementById(i);var s=o.contentWindow||o.contentDocument;if(s.document)s=s.document;aax_write(s,e.html)}catch(d){if(o){o.style.display="none"}}}var amzn_console=function(){"use strict";var e={};e.log=function(){};return e}();if(window.console){amzn_console=window.console}var amznads=function(e,t,a,n){"use strict";var r="https:"===t.location.protocol;e.protocol=r?"https://":"http://";e.host="aax.amazon-adsystem.com";e.dtb_svc="/e/dtb/bid";e.pb_svc="/x/getad";e.px_svc="/x/px/";e.debug_mode=e.debug_mode||false;e.MIN_TIMEOUT=0;e.DEFAULT_TIMEOUT=1e3;e.targetingKey="amznslots";e.vidKey="amzn_vid";e.tasks=e.tasks||[];e.$jQ=e.$jQ||null;e.VIEWABILITY_CUTOFF_AREA=e.VIEWABILITY_CUTOFF_AREA||.5;e.VIEWABILITY_CUTOFF_DURATION_SEC=e.VIEWABILITY_CUTOFF_DURATION_SEC||1;e.isjQueryPresent=function(){if(typeof e.$jQ==="function")return true;try{if(typeof jQuery!="undefined"&&jQuery.fn.on&&jQuery.fn.scrollTop){e.$jQ=jQuery.noConflict(false);return true}}catch(t){}return false};e.log=function(t){try{if(e.debug_mode){n.log(t)}}catch(a){}};e.log("Initiating amznads");if(!e.ads){e.ads={}}e.updateAds=function(t){e.ads=t.ads;if(t.vads){if(!e.ads){e.ads={}}var a;for(a in t.vads){if(t.vads.hasOwnProperty(a)){e.ads[a]=t.vads[a];e.amzn_vid=t.vads[a]}}}e.log("Updated ads. Executing rest of the task queue");e.doAllTasks();e.tasks.push=function(t){e.doTask(t)}};e.saveAds=function(t){e.saved_ads=t.ads;e.updateAds(t)};e.getAdForSlot=function(a,n,r){e.src_id=a;var i=i||{};var o=i.u;if(!o){o=e.getReferrerURL()}if(o&&o.indexOf("amzn_debug_mode")!==-1){e.debug_mode=true}e.log("amznads.getAdForSlot: Using url="+o);var s="src="+e.src_id+"&slot_uuid="+n+"&c=100"+"&u="+o+"&cb="+Math.round(Math.random()*1e7);var d=e.protocol+e.host+e.pb_svc+"?jsd=1&"+s;e.log("amznads.getAdAdForSlot: "+(r?"Async ":"")+"Call to: "+d);if(r){e.appendScriptTag(d)}else{aax_write(t,"<script type='text/javascript' src='"+d+"'></script>")}};e.getAdsCallback=function(t,a,n,r,i){var o=null;var i=i||{};try{if(a&&typeof a==="function"){o=e.handleCallBack(a,n)}}catch(s){e.log("amznads.getAdsAsyncWithCallback(): Error occured in setting up callback functionality."+s)}if(!i.to){i.to=n}e.doGetAdsAsync(t,r,i,o)};e.getAdsAsync=function(t,a,n){e.doGetAdsAsync(t,a,n)};e.handleCallBack=function(t,n){var r=false;var i=null;var o=function(e){if(!r){try{t(e);if(i){clearTimeout(i)}}catch(a){}r=true}};var s=e.getValidMilliseconds(n);if(s){i=a.setTimeout(o,s)}else{i=a.setTimeout(o,e.DEFAULT_TIMEOUT)}return o};e.getValidMilliseconds=function(t){if(!t){return false}try{var a=~~Number(t);if(a>e.MIN_TIMEOUT){return a}}catch(n){e.log("amznads.isValidMilliseconds(): Invalid timeout specified."+n);return false}return false};e.getAds=function(a,n,r,i){if(i){e.doGetAdsAsync(a,n,r);return}else{var o=e.getScriptSource(a,n,r);e.log("amznads.getAds: Call to: "+o);aax_write(t,"<script type='text/javascript' src='"+o+"'></script>")}};e.doGetAdsAsync=function(t,a,n,r){var i=e.getScriptSource(t,a,n);e.log("amznads.getAds: Async Call to: "+i);e.appendScriptTag(i,r)};e.getScriptSource=function(a,n,r){e.src_id=a;var r=r||{};var i=r.u;var o=r.d;var s=r.to;if(!i){i=e.getReferrerURL()}if(i&&i.indexOf("amzn_debug_mode")!==-1){e.debug_mode=true}if(e.ads){e.log("amznads.getAds(): clear out existing ads");e.clearTargetingFromGPTAsync();e.ads={}}if(e.saved_ads){e.ads=e.saved_ads}if(o){try{t.domain=o;e.log("amznads.getAds(): Using domain="+o)}catch(d){e.log("amznads.getAds(): Unable to override document domain with '"+o+"'; exception="+d)}}e.log("amznads.getAds(): Using url="+i);var c="src="+a+"&u="+i+"&cb="+Math.round(Math.random()*1e7);if(n){c+="&sz="+n}if(s){c+="&t="+s}var l=e.protocol+e.host+e.dtb_svc+"?"+c;return l};e.getReferrerURL=function(){var n=encodeURIComponent(t.documentURI);try{n=encodeURIComponent(a.top.location.href);if(!n||n=="undefined")n=e.detectIframeAndGetURL()}catch(r){n=e.detectIframeAndGetURL()}return n};e.detectIframeAndGetURL=function(){try{if(a.top!==a.self){e.log("Script is loaded within iFrame. url="+url);return encodeURIComponent(t.referrer)}}catch(n){return encodeURIComponent(t.documentURI)}};e.appendScriptTag=function(a,n){var r=t.getElementsByTagName("script")[0];var i=t.createElement("script");i.type="text/javascript";i.async=true;i.src=a;try{if(n&&typeof n==="function"){if(i.readyState){i.onreadystatechange=function(){if(i.readyState=="loaded"||i.readyState=="complete"){i.onreadystatechange=null;n(true)}};e.log("amznads.appendScriptTag: setting callBack function for < IE-8 ")}else{i.onload=function(){n(true)};e.log("amznads.appendScriptTag: setting callBack function for all other browsers exluding  < IE-8")}}}catch(o){e.log("amznads.appendScriptTag: Could not associate callBack function; "+o)}r.parentNode.insertBefore(i,r)};e.renderAd=function(t,a){e.log("amznads.renderAd: key="+a+"; ad-tag="+e.ads[a]);if(e.ads[a]){aax_write(t,e.ads[a])}else{var n=new Object;n.c="dtb";n.src=e.src_id;n.kvmismatch=1;n.pubReturnedKey=a;n.aaxReturnedKeys=e.getTokens();n.cb=Math.round(Math.random()*1e7);try{n.u=encodeURIComponent(location.host+location.pathname);if(navigator){n.ua=encodeURIComponent(navigator.userAgent)}}catch(r){}var i=encodeURIComponent(JSON.stringify(n));var o=e.protocol+e.host+"/x/px/p/0/"+i;e.log("amznads.renderAd: keyValueMismatch detected, "+"pubReturnedKey="+a+", aaxReturnedKeys="+e.getTokens());aax_write(t,"<img src='"+o+"'/>")}};e.detectViewability=function(t,n,r,o){if(e.isjQueryPresent()){if(r===a.top){new i(t,e.VIEWABILITY_CUTOFF_AREA,e.VIEWABILITY_CUTOFF_DURATION_SEC,true,n,r,o).collectData()}else{new i(r.frameElement,e.VIEWABILITY_CUTOFF_AREA,e.VIEWABILITY_CUTOFF_DURATION_SEC,true,n,r,o).collectData()}}};function i(n,r,o,s,d,c,l){this.element=n;this.impId=d;this.win=c;this.doc=l;this.start=null;this.end=null;this.area=null;this.cutoff=r;this.cutoffTime=o*1e3;this.focused=null;this.timer=false;this.timerStarted=false;this.getDuration=s;this.reported=false;this.above=null;this.totalTime=0;this.leftPos=null;this.topPos=null;i.prototype.calcArea=function(){try{var n=t.getElementsByTagName("body")[0];var r=a.top.innerWidth||t.documentElement.clientWidth||n.clientWidth;var i=a.top.innerHeight||t.documentElement.clientHeight||n.clientHeight;var o=e.$jQ(a).scrollTop();var s=e.$jQ(this.element).offset().top;var d=e.$jQ(this.element).height();var c=e.$jQ(a).scrollLeft();var l=e.$jQ(this.element).offset().left;var g=e.$jQ(this.element).width();var u=Math.max(s,o);var f=Math.min(s+d,o+i);var m=f-u;m=Math.max(0,m);var h=Math.max(l,c);var p=Math.min(l+g,c+r);var y=p-h;y=Math.max(0,y);var v=m*y;var T=g*d;this.leftPos=l/e.$jQ(t).width();this.topPos=s/e.$jQ(t).height();return v/T}catch(A){e.log("calcArea failed for ad id="+this.element+"; error="+A)}return 0};i.prototype.displayTime=function(){if(this.getDuration){var t=this.end-this.start;e.log(this.element+" viewed for: "+t);this.totalTime+=t}};i.prototype.adInView=function(){e.log(this.element+" IN VIEW")};i.prototype.adNotInView=function(){e.log(this.element+" NOT IN VIEW")};i.prototype.seenForTime=function(){e.log(this.element+" displayed for "+this.cutoffTime/1e3+" seconds");e.log(" ");this.reported=true;try{var t=encodeURIComponent(location.protocol+location.host+location.pathname)}catch(a){this.firePixel('/{"adViewability":[{"error": '+JSON.stringify(encodeURIComponent("Error encoding url - "+a))+"}]}")}try{this.firePixel('/{"adViewability":[{"viewable": true }]}')}catch(a){e.log(a);this.firePixel('/{"adViewability":[{"error": '+JSON.stringify(encodeURIComponent("Error sending pixel - "+a))+"}]}")}};i.prototype.firePixel=function(t){(new Image).src=e.protocol+e.host+e.px_svc+this.impId+t+"&cb="+Math.round(Math.random()*1e7)};i.prototype.getAreaTime=function(){var a=this;function n(){if(!a.reported){a.timer=setTimeout(function(){a.seenForTime()},a.cutoffTime)}}function r(){a.adInView();a.start=new Date;n();a.timerStarted=true}function i(){clearTimeout(a.timer);a.timerStarted=false;a.end=new Date;a.adNotInView();a.displayTime()}if(this.area==null){this.area=this.calcArea();if(this.area>this.cutoff){this.above=true}else{this.above=false}try{this.firePixel('/{"adViewability":[{"above_the_fold": '+this.above+', "topPos": '+this.topPos+', "leftPos": '+this.leftPos+"}]}")}catch(o){e.log(o);this.firePixel('/{"adViewability":[{"error": '+JSON.stringify(encodeURIComponent("Error sending pixel - "+o))+"}]}")}}var s=this.calcArea();if(t.hasFocus()&&(this.focused==false||this.focused==null)&&s>this.cutoff&&this.timerStarted==false){r()}if(t.hasFocus()){this.focused=true}else{if(this.area>this.cutoff&&this.focused==true){i();this.focused=false}}if(this.area>=this.cutoff&&s<this.cutoff||this.area<this.cutoff&&s>=this.cutoff){if(s>=this.cutoff&&this.timerStarted==false){r()}else if(s<this.area){i()}}this.area=s};i.prototype.collectData=function(){var t=this;t.getAreaTime();e.$jQ(a).on("scroll resize focus blur",function(){if(!t.reported){t.getAreaTime()}})}}e.hasAds=function(t){var a;if(!t){try{return Object.keys(e.ads).length>0}catch(n){e.log("amznads.hasAds: looks like IE 8 (and below): "+n);for(a in e.ads){if(e.ads.hasOwnProperty(a)){return true}}}}for(a in e.ads){if(e.ads.hasOwnProperty(a)){if(a.indexOf(t)>0){return true}}}return false};e.getTargeting=function(t){var a={};a[e.targetingKey]=e.getTokens();a[e.vidKey]=e.amzn_vid;return a};e.setTargeting=function(t,a){var n;for(n in e.ads){if(e.ads.hasOwnProperty(n)){if(a&&n.indexOf(a)<0){continue}t(n,"1")}}};e.setTargetingForGPTAsync=function(t){try{if(t){e.targetingKey=t;var a=e.getTokens();if(typeof a!="undefined"&&a.length>0){googletag.cmd.push(function(){googletag.pubads().setTargeting(t,a);googletag.pubads().setTargeting(e.vidKey,e.amzn_vid)})}}else{var n;for(n in e.ads){if(e.ads.hasOwnProperty(n)){(function(){var t=n;e.log("amznads.setTargetingForGPTAsync: pushing localKey="+t);googletag.cmd.push(function(){if(amznads.debug_mode){amznads.log("amznads.setTargetingForGPTAsync: localKey="+t)}googletag.pubads().setTargeting(t,"1");googletag.pubads().setTargeting(e.vidKey,e.amzn_vid)})})()}}}e.log("amznads.setTargetingForGPTAsync: Completed successfully. Number of ads returned by Amazon: "+Object.keys(e.ads).length)}catch(r){e.log("amznads.setTargetingForGPTAsync: ERROR - "+r)}};e.setTargetingForGPTSync=function(t){try{if(t){e.targetingKey=t;var a=e.getTokens();if(typeof a!="undefined"&&a.length>0){googletag.pubads().setTargeting(t,a);googletag.pubads().setTargeting(e.vidKey,e.amzn_vid)}}else{var n;for(n in e.ads){if(e.ads.hasOwnProperty(n)){googletag.pubads().setTargeting(n,"1");googletag.pubads().setTargeting(e.vidKey,e.amzn_vid)}}}e.log("amznads.setTargetingForGPTSync: Completed successfully. Number of ads returned by Amazon: "+Object.keys(e.ads).length)}catch(r){e.log("amznads.setTargetingForGPTSync: ERROR - "+r)}};e.clearTargetingFromGPTAsync=function(){try{if(googletag&&googletag.pubads())googletag.pubads().clearTargeting(e.targetingKey);googletag.pubads().clearTargeting(e.vidKey)}catch(t){}};e.appendTargetingToAdServerUrl=function(t){var a=t;try{if(t.indexOf("?")===-1){t=t+"?"}var n;for(n in e.ads){if(e.ads.hasOwnProperty(n)){t+="&"+n+"=1"}}e.log("amznads.appendTargetingToAdServerUrl: Completed successfully. Number of ads returned by Amazon: "+e.ads.length)}catch(r){e.log("amznads.appendTargetingToAdServerUrl: ERROR - "+r)}e.log("amznads.appendTargetingToAdServerUrl: input url: "+a+"\nreturning url: "+t);return t};e.appendTargetingToQueryString=function(t){var a=t;try{var n;for(n in e.ads){if(e.ads.hasOwnProperty(n)){t+="&"+n+"=1"}}}catch(r){e.log("amznads.appendTargetingToQueryString: ERROR - "+r)}e.log("amznads.appendTargetingToQueryString: input query-string:"+a+"\nreturning query-string:"+t);return t};e.getTokens=function(t){var a,n=[];try{for(a in e.ads){if(e.ads.hasOwnProperty(a)){if(t&&a.indexOf(t)<0){continue}n.push(a)}}}catch(r){e.log("amznads.getTokens: ERROR - "+r)}e.log("amznads.getTokens: returning tokens = "+n);return n};e.getKeys=e.getTokens;e.getVid=function(){return e.amzn_vid};e.doAllTasks=function(){while(e.tasks.length>0){var t=e.tasks.shift();e.doTask(t)}};e.doTask=function(t){try{t.call()}catch(a){e.log("Failed calling task: "+a)}};e.tryGetAdsAsync=function(){if(e.asyncParams){e.getAdsCallback(e.asyncParams.id,e.asyncParams.callbackFn,e.asyncParams.timeout,e.asyncParams.size,e.asyncParams.data)}};return e}(amznads||{},document,window,amzn_console);amznads.tryGetAdsAsync();window["amzn_ads"]=amzn_ads;window["amznads"]=amznads;